<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–≤–µ—Ä–µ–∑–∏–π –í–∞—Å—å–∫–∞</title>
    <style>
        /* body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to bottom, #fdf6e3, #e0f7fa);
            text-align: center;
            padding: 40px;
            margin: 0;
        } */

        body {
            font-family: 'Segoe UI', sans-serif;
            background: #121212;
            color: #e0f2f1;
            text-align: center;
            padding: 40px;
            margin: 0;
        }


        h1 {
            color: #2e7d32;
            font-size: 36px;
            margin-bottom: 20px;
        }

        p {
            font-size: 24px;
            color: #444;
        }

        blockquote {
            font-style: italic;
            color: #00796d;
            margin: 20px auto;
            max-width: 500px;
        }

        /* 
        button {
            padding: 15px 30px;
            font-size: 18px;
            background-color: #388e3c;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
        } */

        button {
            padding: 15px 30px;
            font-size: 18px;
            background-color: #1e88e5;
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            transition: background-color 0.3s ease;
        }

        /* 
        button:hover {
            background-color: #2e7d32;
        } */

        button:hover {
            background-color: #1565c0;
        }

        @media (max-widht: 600px) {
            h1 {
                font-size: 28px;
            }

            p {
                font-size: 20px;
            }

            button {
                font-size: 16px;
                padding: 12px 24px;
            }

            blockquote {
                font-size: 16px;
                margin: 10px auto;
                padding: 10px;
            }
        }
    </style>
</head>


<body>
    <h1>–¢–≤–µ—Ä–µ–∑–∏–π –í–∞—Å—å–∫–∞</h1>
    <p>–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–≤–µ—Ä–µ–∑–∏—Ö –¥–Ω—ñ–≤: <span id="days">0</span></p>
    <blockquote id="quote">"–°–ø—Ä–∞–≤–∂–Ω—è —Å–∏–ª–∞ - —Ü–µ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–±–æ—é"</blockquote>
    <button id="stayStrongBtn">–Ø –Ω–µ –∑–¥–∞–≤—Å—è —Å—å–æ–≥–æ–¥–Ω—ñ</button>

    <!-- –ü–æ–ª—è –≤—Ö–æ–¥—É -->
    <h2>–£–≤—ñ–π—Ç–∏ –∞–±–æ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—å</h2>
    <input type="email" id="email" placeholder="email">
    <input type="password" id="password" placeholder="–ü–∞—Ä–æ–ª—å">
    <button id="registerBtn">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</button>
    <button id="loginBtn">–£–≤—ñ–π—Ç–∏</button>
    <p id="userStatus"></p>

    <script type="module">
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

        // üî• –í–°–¢–ê–í –°–Æ–î–ò —Å–≤—ñ–π firebaseConfig ‚Üì
        const firebaseConfig = {
            apiKey: "AIzaSyDjfn5HTxD5dYfsps--O5dccRhiTbeW2dA",
            authDomain: "tvereziyvasya.firebaseapp.com",
            projectId: "tvereziyvasya",
            storageBucket: "tvereziyvasya.firebasestorage.app",
            messagingSenderId: "877439507683",
            appId: "1:877439507683:web:6195a466e76dfe768139d6",
            measurementId: "G-6PS48H0S9D"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app, "https://tvereziyvasya-default-rtdb.europe-west1.firebasedatabase.app");


        const daysEl = document.getElementById("days");
        const btn = document.getElementById("stayStrongBtn");
        const quoteEl = document.getElementById("quote");
        const email = document.getElementById("email");
        const password = document.getElementById("password");
        const registerBtn = document.getElementById("registerBtn");
        const loginBtn = document.getElementById("loginBtn");
        const userStatus = document.getElementById("userStatus");

        let userId = null;

        const quotes = [
            "–°–ø—Ä–∞–≤–∂–Ω—è —Å–∏–ª–∞ ‚Äî —Ü–µ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–æ–±–æ—é.",
            "–ö–æ–∂–µ–Ω –Ω–æ–≤–∏–π –¥–µ–Ω—å ‚Äî —Ü–µ –Ω–æ–≤–∏–π —à–∞–Ω—Å.",
            "–¢–∏ —Å–∏–ª—å–Ω—ñ—à–∏–π, –Ω—ñ–∂ –∑–¥–∞—î—Ç—å—Å—è.",
            "–û–¥–∏–Ω –¥–µ–Ω—å ‚Äî —Ü–µ –≤–∂–µ –ø–µ—Ä–µ–º–æ–≥–∞.",
            "–¢–≤–µ—Ä–µ–∑—ñ—Å—Ç—å ‚Äî —Ü–µ —Å—É–ø–µ—Ä—Å–∏–ª–∞.",
            "–¢–∏ –Ω–µ —Å–∞–º. –¢–∏ –≤ –¥–æ—Ä–æ–∑—ñ –¥–æ –∫—Ä–∞—â–æ–≥–æ —Å–µ–±–µ."
        ];
        quoteEl.textContent = quotes[Math.floor(Math.random() * quotes.length)];

        const dbRef = ref(db);
        let soberDays = 0;

        // –û–±—Ä–æ–±–∫–∞ –≤—Ö–æ–¥—É
        registerBtn.addEventListener("click", () => {
            createUserWithEmailAndPassword(auth, email.value, password.value)
                .then((userCredential) => {
                    userId = userCredential.user.uid;
                    userStatus.textContent = `–ü—Ä–∏–≤—ñ—Ç, ${email.value}!`;
                })
                .catch((error) => {
                    alert("–ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó: " + error.message);
                });
        });

        loginBtn.addEventListener("click", () => {
            signInWithEmailAndPassword(auth, email.value, password.value)
                .then((userCredential) => {
                    userId = userCredential.user.uid;
                    userStatus.textContent = `–í—ñ—Ç–∞—é –∑ –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è–º, ${email.value}!`;
                    loadSoberDays();
                })
                .catch((error) => {
                    alert("–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É: " + error.message);
                });
        });

        function loadSoberDays() {
            if (!userId) return;
            get(ref(db, `users/${userId}/soberDays`)).then((snapshot) => {
                if (snapshot.exists()) {
                    soberDays = snapshot.val();
                    daysEl.textContent = soberDays;
                } else {
                    soberDays = 0;
                    daysEl.textContent = soberDays;
                }
            });
        }

        btn.addEventListener("click", () => {
            if(!userId){
                alert("–°–ø–µ—Ä—à—É —É–≤—ñ–π–¥–∏!");
                return;
            }
            soberDays++;
            set(ref(db, `users/${userId}/soberDays`), soberDays);
            daysEl.textContent = soberDays;
        });

    </script>

</body>

</html>